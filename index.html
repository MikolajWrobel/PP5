<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="index.js"></script>
  </head>
  <body>
    <div class="container">
      <div id="client-list">
        <ul class="list-group" id="customer-list">
          <!-- Wstaw tutaj liste klientow -->
        </ul>
        <button type="button" class="btn btn-primary" onclick="showForm()">Add new customer</button>      
      </div>
      <div class="form" id="client-form" style="display: none;">
        <h1 id="login-form">Form</h1>
        <div class="d-flex justify-content-center">
          <div class="w-50">
            <form  onsubmit="return save(event)">
              <div class="mb-3 content-center">
                <label for="company-name" class="form-label">Company name</label>
                <input type="text" class="form-control" id="company-name">
              </div>
              <div class="mb-3">
                <label for="nip" class="form-label">NIP</label>
                <input type="number" class="form-control" id="nip" required>
              </div>
              <div class="mb-3">
                  <label for="city" class="form-label">City</label>
                  <input type="text" class="form-control" id="city" required>
                </div>
                <div class="mb-3">
                  <label for="street" class="form-label">Street</label>
                  <input type="text" class="form-control" id="street" required>
                </div>
                <div class="mb-3">
                  <label for="house-number" class="form-label">House nr</label>
                  <input type="TEXT" class="form-control" id="house-number">
                </div>
                <div class="mb-3">
                  <label for="zipcode" class="form-label">Zip code</label>
                  <input type="text" class="form-control" id="zipcode" required>
                </div>
              <div>
                <div class="mb-3">
                  <label for="comments" class="form-label">Comments</label>
                  <textarea type="text" class="form-control" id="comments"></textarea>
                </div>
                <div class="mb-3">
                  <label for="industry" class="form-label">Industry</label>
                  <select type="number" class="form-control" id="industry">
                    <option value="1">Informatyka</option>
                    <option value="2">Kosmetyka</option>
                  </select>
                </div>
                <div class="mb-3 form-check">
                  <input type="checkbox" class="form-check-input" id="active">
                  <label class="form-check-label" for="active">Active</label>
                </div>
              </div>
              <button type="submit" class="btn btn-primary" >Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script>
      const customersList = [];

      function showCustomer() {
        document.getElementById("customer-list").innerHTML = '';
        customersList.forEach((customer) => {
          let ul = document.getElementById("customer-list");
          ul.innerHTML += `<li class="list-group-item" onclick="showForm();loadClient(${customer.nip});">${customer.name} (${customer.nip})</li>`;
        });
        showList();
      }

      function showForm(){
        document.getElementById("client-form").style.display = "block";
        document.getElementById("client-list").style.display = "none";
      }
      
      function showList(){
        document.getElementById("client-form").style.display = "none";
        document.getElementById("client-list").style.display = "block";
      }

      function save(event) {
        event.preventDefault();
        let newCustomer = {
            name: document.getElementById("company-name").value,
            nip: document.getElementById("nip").value,
            city: document.getElementById("city").value,
            street: document.getElementById("street").value,
            houseNumber: document.getElementById("house-number").value,
            zipCode: document.getElementById("zipcode").value,
            comments: document.getElementById("comments").value,
            industry: document.getElementById("industry").value,
            active: document.getElementById("active").checked,
        }
        let foundCustomer = null;
        for (let i = 0; i < customersList.length; i++) {
          if(customersList[i].nip == newCustomer.nip){
            foundCustomer = customersList[i];
            customersList[i] = newCustomer;
          }
        }
        if(foundCustomer == null){
          customersList.push(newCustomer);
        }
        console.log(customersList)
        showCustomer();
      }

      function loadClient(nip) {
        let newCustomer = customersList.find((customer) => customer.nip == nip);
        if(newCustomer == null){
          newCustomer = getEmptyCustomer();
        }
        document.getElementById("company-name").value = newCustomer.name
        document.getElementById("nip").value = newCustomer.nip
        document.getElementById("city").value = newCustomer.city
        document.getElementById("street").value = newCustomer.street
        document.getElementById("house-number").value = newCustomer.houseNumber
        document.getElementById("zipcode").value = newCustomer.zipCode
        document.getElementById("comments").value = newCustomer.comments
        document.getElementById("industry").value = newCustomer.industry
        document.getElementById("active").checked = newCustomer.active
      }

      function getEmptyCustomer(){
        return {
              name: "",
              nip: '',
              city: "",
              street: "",
              houseNumber: '',
              zipCode: '',
              comments: "",
              industry: '',
              active: true,
          };
      }
    </script>
  </body>
</html>